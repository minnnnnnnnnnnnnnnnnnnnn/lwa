@page "/cases/detail"
@inject HttpClient Http
@inject NavigationManager NavManager

<PageTitle>@a - 臺中市立臺中第一高級中等學校學生自治聯合會法規資料庫</PageTitle>
<div class="bread">
    <span>現在位置：</span>
    <ul>
        <li><a href="">首頁</a></li>
        <li><a href="cases">判例查詢</a></li>
        <li>判例詳細資料</li>
    </ul>
</div>
@if( a == "" || a == null ) 
{
    <span>沒有這個東西啦！</span>
}
<h1>@a</h1>
@if (cases == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <div class="cd">
        <dl>
            <dt>判決字號</dt>
            <dd>@cases[0].Cases[i].No</dd>
            <dt>類別</dt>
            <dd>@cases[0].Cases[i].Category</dd>
            @if( @cases[0].Cases[i].DeliberationDate != "" ) 
            {
                <dt>判決日期</dt>
                <dd>@cases[0].Cases[i].DeliberationDate</dd>
            }
            @if( @cases[0].Cases[i].Petitioner != "" ) 
            {
                <dt>聲請人</dt>
                <dd>@cases[0].Cases[i].Petitioner</dd>
            }
            @if( @cases[0].Cases[i].Plaintiff != "" ) 
            {
                <dt>原告</dt>
                <dd>@cases[0].Cases[i].Plaintiff</dd>
            }
            @if( @cases[0].Cases[i].Defendant != "" ) 
            {
                <dt>被告</dt>
                <dd>@cases[0].Cases[i].Defendant</dd>
            }
            @if( @cases[0].Cases[i].Title != "" ) 
            {
                <dt>標題</dt>
                <dd>@cases[0].Cases[i].Title</dd>
            }
            @if( @cases[0].Cases[i].Cause != "" ) 
            {
                <dt>案由</dt>
                <dd>@cases[0].Cases[i].Cause</dd>
            }
            @if( @cases[0].Cases[i].Syllabus != "" ) 
            {
                <dt>主文</dt>
                <dd>@cases[0].Cases[i].Syllabus</dd>
            }
            @if( @cases[0].Cases[i].State != "" ) 
            {
                <dt>狀態</dt>
                <dd>@cases[0].Cases[i].State</dd>
            }
            @if( @cases[0].Cases[i].FullJudgement != "" ) 
            {
                <dt>判決全文（URL）</dt>
                <dd>
                    <a href="@cases[0].Cases[i].FullJudgement" target="_blank">
                        <span>@cases[0].Cases[i].FullJudgement</span>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ex-link">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                            <polyline points="15 3 21 3 21 9"></polyline>
                            <line x1="10" y1="14" x2="21" y2="3"></line>
                        </svg>
                    </a>
                </dd>
            }
            @if (@cases[0].Cases[i].Rulings.Length != 0)
            {
                <dt>裁定</dt>
                <div class="cd r">
                    @foreach (var cassr in @cases[0].Cases[i].Rulings)
                    {
                        <dl>
                            <dt>裁定字號</dt>
                            <dd>@cassr.RulingNo</dd>
                            <dt>裁定全文（URL）</dt>
                            <dd>
                                <a href="@cassr.FullRulingURL" target="_blank">
                                    <span>@cassr.FullRulingURL</span>
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ex-link">
                                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                        <polyline points="15 3 21 3 21 9"></polyline>
                                        <line x1="10" y1="14" x2="21" y2="3"></line>
                                    </svg>
                                </a>
                            </dd>
                        </dl>
                    }
                </div>
            }
            @if (@cases[0].Cases[i].Opinions.Length != 0)
            {
                <dt>意見書</dt>
                <div class="cd o">
                    @foreach (var casso in @cases[0].Cases[i].Opinions)
                    {
                        <dl>
                            <dt>類型</dt>
                            <dd>@casso.Type</dd> 
                            <dt>委員</dt>
                            <dd>@casso.Member</dd> 
                            <dt>意見書全文（URL）</dt>
                            <dd>
                                <a href="@casso.URL" target="_blank">
                                    <span>@casso.URL</span>
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ex-link">
                                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                        <polyline points="15 3 21 3 21 9"></polyline>
                                        <line x1="10" y1="14" x2="21" y2="3"></line>
                                    </svg>
                                </a>
                            </dd>
                        </dl>
                    }
                </div>
            }
        </dl>
    </div>
}

@code {
    private Casess[]? cases;
    private string a;
    int i ; 
    protected override void OnInitialized()
    {
        var uri = NavManager.ToAbsoluteUri(NavManager.Uri);
        var queryStrings = QueryHelpers.ParseQuery(uri.Query);
        if(queryStrings.TryGetValue("case", out var aaa))
        {
            a = aaa;
        }
    }

    protected override async Task OnInitializedAsync()
    {
        cases = await Http.GetFromJsonAsync<Casess[]>("json/cases.json");
        for (int iii = 0; iii < cases[0].Cases.Length; iii++)
        {
            if (a == cases[0].Cases[iii].No)
            {
                i = iii;
                break;
            }
        }
    }

    public class Casess
    {
        public string UpdateDate { get; set; }
        public Case[] Cases { get; set; }
    }
    public class Case 
    {
        public string No { get; set; }
        public string Category { get; set; }
        public string? DeliberationDate { get; set; }
        public string? Petitioner { get; set; }
        public string? Plaintiff { get; set; }
        public string? Defendant { get; set; }
        public string? Title { get; set; }
        public string? Cause { get; set; }
        public string? Syllabus { get; set; }
        public string? State { get; set; }
        public string? FullJudgement { get; set; }
        public R[]? Rulings { get; set; }
        public O[]? Opinions { get; set; } 
    }
    public class R 
    {
        public string RulingNo { get; set; }
        public string FullRulingURL { get; set; }
    }
    public class O 
    {
        public string Type { get; set; }
        public string Member { get; set; }
        public string URL { get; set; }
    }
}
